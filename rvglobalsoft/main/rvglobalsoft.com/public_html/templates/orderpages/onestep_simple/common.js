function appendLoader(a){loaders[loaders.length]=a}function isEmpty(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function ajax_update(a,b,c,d){d&&$(c).html('<center><img src="ajax-loading.gif" /></center>'),b!=undefined&&isEmpty(b)&&(b={empty1m:"param"}),$.post(a,b,function(a){var b=parse_response(a);if(!b)return $(c).html(""),!1;$(c).html(b),fixHeights()})}function parse_response(data){if(data.indexOf("<!-- {")!=0)return!1;var codes=eval("("+data.substr(data.indexOf("<!-- ")+4,data.indexOf("-->")-4)+")"),i=0;for(i=0;i<codes.ERROR.length;i++)$("#errors").append("<span >"+codes.ERROR[i]+"</span>");for(i=0;i<codes.INFO.length;i++)$("#infos").append("<span >"+codes.INFO[i]+"</span>");return $("#errors").find("span").length>0&&($("#errors").slideDown(),reBind()),$("#infos").find("span").length>0&&($("#infos").slideDown(),reBind()),data.substr(data.indexOf("-->")+3,data.length)}function reBind(){$(".close").unbind("click"),$(".close").click(function(){return $(this).parent().fadeOut("fast",function(){$(this).find("span").remove()}),!1})}function fixHeights(){return!1}var cansearch=!0,loaders=new Array;$.extend($.fn,{slideToElement:function(a){var b=$("a[name="+a+"]");if(b.length){var c=b.offset().top;return $("html,body").animate({scrollTop:c-100},500,"linear",function(){}),!1}},addLoader:function(){var a=$(this).width(),b=$(this).height();a+=parseInt($(this).css("padding-left"),10)+parseInt($(this).css("padding-right"),10),b+=parseInt($(this).css("padding-top"),10)+parseInt($(this).css("padding-bottom"),10);if($("#preloader").length>0)$("#preloader").css({width:a+"px",height:b+"px"}),$("#preloader").show();else{var c='<div id="preloader" style="position:absolute;top:'+$(this).position().top+"px;left:"+$(this).position().left+"px;width:"+a+"px;height:"+b+'px;"></div> ';$(this).append(c)}},TabbedMenu:function(a){var b=a!=undefined&&a.elem!=undefined?a.elem:".tabb",c=a!=undefined&&a.num!=undefined?a.num:0;return $(b).hide(),$(b).eq(c).show(),$("a.tchoice").eq(c).addClass("picked"),$(this).find("a.tchoice").each(function(a){$(this).click(function(){return $(b).hide(),$(b).eq(a).show(),$("a.tchoice").removeClass("picked"),$(this).addClass("picked"),!1})}),$(this)},ajaxHint:function(){$(this).each(function(){$(this).keyup(function(){cansearch&&($(this).val()!=""&&$(this).val()!=" "?(cansearch=!1,$.post("?cmd=tickets&action=kbhint",{query:$(this).val()},function(a){cansearch=!0;var b=parse_response(a);b!==!1&&typeof b=="string"&&b!=""&&($("#hintarea").html(b),$("#hintarea").is(":visible")||$("#hintarea").slideDown())})):$("#hintarea").slideUp("fast",function(){$(this).html("")}))})})}}),this.vtip=function(){this.xOffset=-10,this.yOffset=10,$(".vtip_description").unbind().live("mouseover",function(a){this.t=this.title,this.title="",this.top=a.pageY+yOffset,this.left=a.pageX+xOffset,$("body").append('<p id="vtip">'+this.t+"</p>"),$("p#vtip").css("top",this.top+"px").css("left",this.left+"px").fadeIn("slow")}).live("mouseout",function(){this.title=this.t,$("p#vtip").fadeOut("slow").remove()}).find("small").hide()},$(document).ready(function(){function CSRFProtection(a){var b=$('meta[name="csrf-token"]').attr("content");b&&a.setRequestHeader("X-CSRF-Token",b)}"ajaxPrefilter"in $?$.ajaxPrefilter(function(a,b,c){CSRFProtection(c)}):$(document).ajaxSend(function(a,b){CSRFProtection(b)}),$("#langchange ul").hover(function(){$(this).addClass("show")},function(){$(this).removeClass("show")}),vtip(),$(".sh1a .orderboxpadding").click(function(){var a=$(this).parent().find(".subdesc_").eq(0);$(a).is(":visible")?$(a).hide():$(a).show()}),$("a.sortorder").click(function(){return $("#updater").addLoader(),$("#checkall").attr("checked",!1),$("#currentlist").attr("href",$(this).attr("href")),$("a.sortorder").removeClass("asc"),$("a.sortorder").removeClass("desc"),$(this).attr("href").substring($(this).attr("href").lastIndexOf("|"))=="|ASC"?($(this).addClass("asc"),$(this).attr("href",$(this).attr("href").substring(0,$(this).attr("href").lastIndexOf("|"))+"|DESC")):($(this).addClass("desc"),$(this).attr("href",$(this).attr("href").substring(0,$(this).attr("href").lastIndexOf("|"))+"|ASC")),ajax_update($("#currentlist").attr("href"),{page:$("#currentpage").val(),layer:"ajax"},"#updater"),!1}),$("#currentpage").change(function(){$("#updater").addLoader(),$("#checkall").attr("checked",!1),ajax_update($("#currentlist").attr("href"),{page:$("#currentpage").val(),layer:"ajax"},"#updater")}),$(".submiter").click(function(){$("#updater").addLoader(),$("#checkall").attr("checked",!1);var a="";return $(this).hasAttribute("queue")&&(a="push"),ajax_update($("#currentlist").attr("href")+"&"+$("#testform").serialize()+"&"+$(this).attr("name"),{layer:"ajax",stack:a},"#updater"),!1}),reBind(),$("#ticketmessage").ajaxHint(),setTimeout(function(){$("#errors").find("span").length>0&&$("#errors").slideDown(),$("#infos").find("span").length>0&&$("#infos").slideDown(),fixHeights()},30);if(loaders.length>0){var i=0;for(i=0;i<loaders.length;i++)eval(loaders[i]+"()")}(function(a){var b=0,c=100,d=a("#submenu").height()>32?32:a("#submenu").height(),e=a(".pa1 a","#submenu"),f=e.length;a("#submenu").css("position","relative").height(d),e.each(function(d){b==0&&a(this).width()+a(this).position().left>650&&(b=d),a(this).width()>c&&(c=a(this).width())});if(b>0){var g=a("<div></div>").attr("id","subsubmenu").hide().css("top",a("#submenu").height()-3).width(c+20),h=a("<a></a>").text("More").attr("id","moreitems");for(i=f;i>=b;i--)g.prepend(e.eq(i));a("#submenu").append(g),a(".pa1","#submenu").append(h),g.css("left",h.position().left),h.hover(function(){g.show()},function(){g.hide()}),g.hover(function(){g.show()},function(){g.hide()})}})(jQuery)})